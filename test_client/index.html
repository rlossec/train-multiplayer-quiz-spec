<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test WebSocket - Multiplayer Game</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h1>Test WebSocket - Multiplayer Game</h1>

      <div id="status" class="status disconnected">Déconnecté</div>

      <!-- Messages en position fixe -->
      <div class="messages-fixed" id="messagesFixed">
        <div class="messages-section">
          <div class="messages-header">
            <h3>Messages</h3>
            <button class="toggle-messages" onclick="toggleMessages()" id="toggleMessagesBtn">📱</button>
          </div>
          <div id="messages" class="messages"></div>
          <div class="messages-controls">
            <button onclick="clearMessages()">Effacer</button>
            <button onclick="copyAllMessages()">📋 Copier</button>
          </div>
        </div>
      </div>

      <!-- Layout principal avec onglets -->
      <div class="main-layout">
        <!-- Système d'onglets -->
        <div class="tabs-container">
            <div class="tabs-header">
              <button
                class="tab-button active"
                onclick="switchTab('servers')"
                id="tab-servers"
              >
                🌐 Serveurs
              </button>
              <button
                class="tab-button"
                onclick="switchTab('connection')"
                id="tab-connection"
              >
                🔌 Connexion
              </button>
              <button
                class="tab-button"
                onclick="switchTab('lobby')"
                id="tab-lobby"
              >
                🎮 Lobby
              </button>
            </div>

            <!-- Onglet Serveurs -->
            <div class="tab-content active" id="content-servers">
              <h3>🌐 Statut des Serveurs</h3>
              <div class="server-status">
                <div class="server-item">
                  <span class="server-label">HTTP Server:</span>
                  <span id="httpStatus" class="server-indicator unknown"
                    >❓ Test en cours...</span
                  >
                </div>
                <div class="server-item">
                  <span class="server-label">WebSocket Server:</span>
                  <span id="wsStatus" class="server-indicator unknown"
                    >❓ Test en cours...</span
                  >
                </div>
              </div>
              <button onclick="testServerConnectivity()" type="button">
                🔍 Tester la connectivité
              </button>

              <hr />

              <h3>⚙️ Configuration</h3>
              <div class="form-group">
                <label for="websocketUrl">URL WebSocket:</label>
                <input
                  type="text"
                  id="websocketUrl"
                  value=""
                  placeholder="ws://localhost:8000/game/ws"
                />
              </div>
              <div class="form-group">
                <label for="httpBaseUrl">URL HTTP Base:</label>
                <input
                  type="text"
                  id="httpBaseUrl"
                  value=""
                  placeholder="http://localhost:8000"
                />
              </div>
              <button onclick="updateConfigFromUI()" type="button">
                🔄 Mettre à jour la configuration
              </button>
            </div>

            <!-- Onglet Connexion -->
            <div class="tab-content" id="content-connection">
              <div class="form-group">
                <label for="socketId">Socket ID:</label>
                <input
                  type="text"
                  id="socketId"
                  value=""
                  placeholder="Entrez un ID unique"
                />
                <button onclick="generateNewSocketId()" type="button">
                  🔄 Nouveau ID
                </button>
              </div>

              <div class="form-group">
                <button id="connectBtn" onclick="connect()">
                  Se connecter
                </button>
                <button id="disconnectBtn" onclick="disconnect()" disabled>
                  Se déconnecter
                </button>
                <button onclick="ping()" disabled id="pingBtn">Ping</button>
              </div>
            </div>

            <!-- Onglet Lobby -->
            <div class="tab-content" id="content-lobby">
              <h3>📋 Liste des Lobbies</h3>
              <div class="form-group">
                <button onclick="fetchLobbyList()" class="btn btn-primary">
                  🔍 Récupérer la liste des lobbies
                </button>
              </div>
              <div id="lobbyList" class="lobby-list"></div>

              <h3>Créer un Lobby</h3>
              <div class="form-group">
                <label for="lobbyName">Nom du lobby:</label>
                <input
                  type="text"
                  id="lobbyName"
                  value=""
                  placeholder="Nom du lobby"
                />
              </div>
              <div class="form-group">
                <label for="ownerName">Nom du propriétaire:</label>
                <input
                  type="text"
                  id="ownerName"
                  value=""
                  placeholder="Votre nom"
                />
              </div>
              <div class="form-group">
                <label for="ownerColor">Couleur:</label>
                <select id="ownerColor">
                  <option value="red">Rouge</option>
                  <option value="blue">Bleu</option>
                  <option value="green">Vert</option>
                  <option value="yellow">Jaune</option>
                </select>
              </div>
              <div class="form-group">
                <label for="maxPlayersCreate">Nombre max de joueurs:</label>
                <input
                  type="number"
                  id="maxPlayersCreate"
                  value=""
                  min="2"
                  max="10"
                />
              </div>
              <div class="form-group">
                <label>
                  <input type="checkbox" id="adminIsPlayer" checked />
                  L'admin est un joueur actif
                </label>
              </div>
              <button onclick="createLobby()" disabled id="createBtn">
                Créer un Lobby
              </button>

              <hr />

              <h3>Rejoindre un Lobby</h3>
              <div class="form-group">
                <label for="lobbyCode">Code du Lobby:</label>
                <input
                  type="text"
                  id="lobbyCode"
                  placeholder="Entrez le code du lobby"
                />
              </div>
              <div class="form-group">
                <label for="playerName">Nom du joueur:</label>
                <input
                  type="text"
                  id="playerName"
                  value=""
                  placeholder="Votre nom"
                />
              </div>
              <div class="form-group">
                <label for="playerColor">Couleur:</label>
                <select id="playerColor">
                  <option value="red">Rouge</option>
                  <option value="blue">Bleu</option>
                  <option value="green">Vert</option>
                  <option value="yellow">Jaune</option>
                </select>
              </div>
              <button onclick="joinLobby()" disabled id="joinBtn">
                Rejoindre le Lobby
              </button>

              <hr />

              <h3>Actions</h3>
              <button onclick="startGame()" disabled id="startBtn">
                Démarrer la Partie
              </button>

              <hr />

              <h3>🎮 Zone de Jeu</h3>
              <div id="gameSection" style="display: none">
                <div class="form-group">
                  <label for="buzzAnswer">Ma réponse:</label>
                  <input
                    type="text"
                    id="buzzAnswer"
                    placeholder="Tapez votre réponse ici..."
                  />
                </div>
                <div class="form-group">
                  <label for="timeToAnswer">Temps de réponse (secondes):</label>
                  <input
                    type="number"
                    id="timeToAnswer"
                    value="0"
                    min="0"
                    step="0.1"
                    placeholder="Temps en secondes"
                  />
                </div>
                <button onclick="sendBuzz()" disabled id="buzzBtn">
                  🚨 BUZZ !
                </button>
              </div>

              <hr />

              <h3>👑 Gestion Admin</h3>
              <div id="adminSection" style="display: none">
                <div class="form-group">
                  <label for="questionNumber">Numéro de question:</label>
                  <input
                    type="number"
                    id="questionNumber"
                    value="1"
                    min="1"
                    placeholder="Numéro de question"
                  />
                </div>
                <button
                  onclick="closeQuestion()"
                  disabled
                  id="closeQuestionBtn"
                >
                  🔒 Fermer la Question
                </button>
                <button onclick="nextQuestion()" disabled id="nextQuestionBtn">
                  ➡️ Question Suivante
                </button>
                <button onclick="endGame()" disabled id="endGameBtn">
                  🏁 Terminer la Partie
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js"></script>
  </body>
</html>
